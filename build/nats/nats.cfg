tls {
  cert_file: "/etc/nats-certificates/nats.cer"
  key_file:  "/etc/nats-certificates/nats.key"
  ca_file:   "/etc/nats-certificates/ca.cer"
  verify_and_map: true
  ocsp_peer: true
}

authorization: {  
  users = [
    {user: "CN=OpenUEM Cert-Manager Worker,OU=worker,O=OpenUEM,POSTALCODE=,STREET=,L=,ST=,C=ES,", permissions: {
      subscribe: "certificates.>"
    }},
    {user: "CN=OpenUEM Notification Worker,OU=worker,O=OpenUEM,POSTALCODE=,STREET=,L=,ST=,C=ES,", permissions: {
      subscribe: "notification.>"
    }},
    {user: "CN=OpenUEM Console,O=OpenUEM,POSTALCODE=,STREET=,L=,ST=,C=ES,", permissions: {
      publish: ["agent.>", "notification.>", "certificates.>"]
    }},
    {user: "CN=OpenUEM Agent Worker,OU=worker,O=OpenUEM,POSTALCODE=,STREET=,L=,ST=,C=ES,", permissions: { 
      sub: {
        allow: ["report openuem-agents", "deployresult openuem-agents"]
      }
    }},
    {user: "CN=OpenUEM Agent,O=OpenUEM,POSTALCODE=,STREET=,L=,ST=,C=ES,", permissions: {
      sub: {
        allow: ["_INBOX.>", "agent.installpackage.>", "agent.uninstallpackage.>", "agent.updatepackage.>", "agent.enable.> openuem-agent-management", "agent.disable.> openuem-agent-management", "agent.report.> openuem-agent-management", "agent.startvnc.> openuem-agent-management", "agent.stopvnc.> openuem-agent-management"]
      },
      publish: ["report", "_INBOX.>", "deployresult"]
    }},
  ]
}
